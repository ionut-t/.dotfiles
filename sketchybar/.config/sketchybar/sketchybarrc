#!/bin/bash

# Catppuccin Mocha palette
export BASE=0xff1e1e2e
export SURFACE0=0xff313244
export TEXT=0xffcdd6f4
export SUBTEXT=0xffa6adc8
export BLUE=0xff89b4fa
export TRANSPARENT=0x00000000

PLUGIN_DIR="$CONFIG_DIR/plugins"

# ── Bar appearance ──────────────────────────────────────────
sketchybar --bar \
  height=28 \
  blur_radius=30 \
  position=top \
  sticky=off \
  notch_width=0 \
  padding_left=6 \
  padding_right=6 \
  color=$TRANSPARENT \
  border_width=0 \
  shadow=off \
  topmost=off

# ── Defaults ────────────────────────────────────────────────
sketchybar --default \
  label.font="SF Mono:Bold:11.0" \
  label.color=$SUBTEXT \
  background.color=$TRANSPARENT \
  background.corner_radius=4 \
  background.height=20 \
  padding_left=2 \
  padding_right=2 \
  label.padding_left=6 \
  label.padding_right=6 \
  icon.drawing=off

# ── AeroSpace workspaces (left) ─────────────────────────────
sketchybar --add event aerospace_workspace_change
for sid in $(aerospace list-workspaces --all); do
  sketchybar --add item space.$sid left \
    --subscribe space.$sid aerospace_workspace_change front_app_switched \
    --set space.$sid \
      background.color=$SURFACE0 \
      background.drawing=off \
      label="$sid" \
      drawing=off \
      click_script="aerospace workspace $sid" \
      script="$PLUGIN_DIR/aerospace.sh $sid"
done

# ── Force initial update ────────────────────────────────────
sketchybar --update
